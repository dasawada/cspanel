<html lang="zh-Hant">
<head>
    <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-1638R1H1FB"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-1638R1H1FB');
</script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>★客服小工具ALL★</title>
<style>
body {
font-size: 10px; overflow-x: hidden;
font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
}

table {
width: 100%;
border-collapse: collapse;
height: 900px;            
}

th, td {
text-align: left;
}
/* 檔次提示語樣式 */
#copyMessage { 
font-size: 12px; 
color: #ff0000; 
}
/* OP標題複製、不可選取的按鈕樣式 */
.unclickable {
pointer-events: none;
opacity: 0.6;
cursor: not-allowed;
}

.responsive-iframe {
width: 200%;
height: 600px;
overflow: hidden; /* 完全禁用卷軸 */
border: none;
}
        #content {
            display: none;
            height: 100%;
        }
        td {
            border: 1px solid transparent;
            vertical-align: top;
        }
        /*調整td元素的寬度 */
        td.left {
            width: 400px; /* 確保左邊列寬度為400px */
            
        }
        td.right {
            width: auto; /* 右邊列寬度自動調整 */
                        
        }
        /* iframe样式 */
        #usersearch {
            width: 100%;
            height: 400px;
            border: none;
        }
        #logsearch {
            width: 100%;
            height: 600px;
            border: none;
        }
    
    /* 設定包含卷軸的 div 的樣式 */
.Leftpanel {
  width: 100%;
  height: 100%; 
  font-size: 14px;
  color: #4d4d4d;
  border: 1px solid #ccc; 
  padding: 10px;
  border-radius: 10px; /* 設定圓角半徑為 10px */
}

.RightPanel {
  width: 100%;
  height: 100%; 
  padding: 0 10px 0 15px;
}

#optitleoutput {
    height: 25px;
    overflow: hidden;
}

button {
    background-color: #f0f0f0;
    color: #000000;
    padding: 2px 6px;
    border: 1px solid #bfbfbf;
    border-radius: 4px;
    cursor: pointer;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif; /* 使用 macOS 系統字體 */
    box-shadow: 0 1px 4px rgba(0, 0, 0, 0.1);  /* 模仿 macOS 按鈕陰影 */
transition: background-color 0.1s ease;
}

/* 按鈕懸停時的效果 */
button:hover {
    background-color: #dbdbdb;
}
/* 按鈕點擊時的效果 */
button:active {
    background-color: #949494; 
}

/* 輸入框樣式 */
input[type=text], input[type=password] {
    color: #8f8f8f;
    width: 100%;
    padding: 2px 4px;
    margin: 0px 0;
    display: inline-block;
    border: 1px solid #d9d9d9;
    border-radius: 4px;
    box-sizing: border-box;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif; /* 使用 macOS 系統字體 */ 
    box-shadow: 0 1px 4px rgba(0, 0, 0, 0.1); /* 模仿 macOS 輸入框陰影 */
}

/* 聚焦時的效果 */
input[type=text]:focus, input[type=password]:focus {
    border: 1px solid #949494 !important;
    color:#292828;
    outline: none; /* 移除默認的 outline */
}

/* 點名鈕基本樣式 */
        .DienMing {
            background-color: #daf5cc;
            color: #000000;
            padding: 2px 6px;
            border: 1px solid #bfbfbf;
            border-radius: 4px;
             cursor: pointer;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif; /* 使用 macOS 系統字體 */
    box-shadow: 0 1px 4px rgba(0, 0, 0, 0.1); /* 模仿 macOS 按鈕陰影 */
transition: background-color 0.1s ease;
        }

        /* 滑鼠懸停時的效果 */
        .DienMing:hover {
            background-color: #93d470; /* 懸停時的背景顏色 */
        }

        /* 按下時的效果 */
        .DienMing:active {
            background-color: #9cba8c; /* 按下時的背景顏色 */
        }

/* 解除點名鈕基本樣式 */
        .deactiveDienMing {
            background-color: #ffe6d7;
            color: #000000;
            padding: 2px 6px;
            border: 1px solid #bfbfbf;
            border-radius: 4px;
             cursor: pointer;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif; /* 使用 macOS 系統字體 */
    box-shadow: 0 1px 4px rgba(0, 0, 0, 0.1); /* 模仿 macOS 按鈕陰影 */
transition: background-color 0.1s ease;
        }

        /* 滑鼠懸停時的效果 */
        .deactiveDienMing:hover {
            background-color: #f2b794; /* 懸停時的背景顏色 */
        }

        /* 按下時的效果 */
        .deactiveDienMing:active {
            background-color: #c7a18b; /* 按下時的背景顏色 */
        }
</style>
</head>
<body>
<div style="float: right; font-size: 10pt; color: #888888;">※版本更新：2024/06/10</div>

<button onclick="copyToClipboard('OneClass真人Live家教_體驗接待大廳_A')" style="font-size: 12px;">LINE大廳A</button>
<button onclick="copyToClipboard('OneClass真人Live家教_官方臉書_A')" style="font-size: 12px;">FB_A</button>
<button onclick="copyToClipboard('直播公開課_A')" style="font-size: 12px;">直播_A</button>
<button onclick="copyToClipboard('電話進線_A')" style="font-size: 12px;">電話進線_A</button>
<button onclick="copyToClipboard('2024年XX月_MGM名單_B')" style="font-size: 12px;">MGM_B</button>
<p>
<button class="DienMing" onclick="copyToClipboard_F12script('\
// 老師點名\n\
function showRows() {\n\
    // 選擇所有具有類名 .MuiTableRow-root 的元素\n\
    var rows = document.querySelectorAll(\'.MuiTableRow-root\');\n\
    // 遍歷每個行元素\n\
    rows.forEach(function(row) {\n\
        var cells = row.querySelectorAll(\'.MuiTableCell-root\');\n\
        var shouldShowRow = false;\n\
        // 檢查每個單元格中的內容\n\
        cells.forEach(function(cell) {\n\
            // 在每個單元格元素中查找是否存在類名為 .MuiBox-root.css-1v9l4og 的子元素\n\
            var box1 = cell.querySelector(\'.MuiBox-root.css-1v9l4og\');\n\
            // 在每個單元格元素中查找是否存在類名為 .MuiBox-root.css-1tqg586 的子元素\n\
            var box2 = cell.querySelector(\'.MuiBox-root.css-1tqg586\');\n\
            // 如果找到了符合條件的子元素，且第二個子元素沒有其他子元素\n\
            if (box1 && box2 && !box2.querySelector(\'.MuiBox-root\')) {\n\
                shouldShowRow = true;\n\
            }\n\
        });\n\
        // 根據 shouldShowRow 的值顯示或隱藏整行\n\
        row.style.display = shouldShowRow ? \'table-row\' : \'none\';\n\
    });\n\
}\n\
// 在延遲1秒後執行顯示/隱藏行的函數\n\
setTimeout(showRows, 1000);\n\
', '【點名】函數已複製')">點名</button>

<button class="deactiveDienMing" onclick="copyToClipboard_F12script('\
// 解除點名\n\
function showAllRows() {\n\
    // 選擇所有具有類名 .MuiTableRow-root 的元素\n\
    var rows = document.querySelectorAll(\'.MuiTableRow-root\');\n\
    // 將所有行顯示\n\
    rows.forEach(function(row) {\n\
        row.style.display = \'\'; // 設置為空字符串，以使用默認的顯示方式\n\
    });\n\
}\n\
// 在延遲1秒後執行完全顯示所有行的函數\n\
setTimeout(showAllRows, 1000);\n\
', '【解除點名】函數已複製')">解除點名</button>
<button onclick="copyToClipboard_F12script('老師您好，現在的課程您還沒有進教室喔，請問有發生什麼狀況需要協助嗎？', '【老師未到】話術已複製')" >老師未到</button>
</p>



<div id="copyMessage"></div>

    <table>
        <tr>
            <td class="left">
                <div class="Leftpanel">
                
<form id="consultantForm" style="margin: 0; width: 200px;">
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 5px;">
        <b>OP標題生成</b>
        <button type="button" onclick="clearFields()" style="font-size: 11px;">清空欄位</button>
    </div>
    <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
        <label for="consultantName" style="width: 40px;">顧問 :</label>
        <input type="text" id="consultantName" name="consultantName" oninput="checkInputs()" style="width: calc(100% - 40px);">
    </div>
    <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
        <label for="studentName" style="width: 40px;">學生 :</label>
        <input type="text" id="studentName" name="studentName" oninput="checkInputs()" style="width: calc(100% - 40px);">
    </div>
    <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
        <label for="parentName" style="width: 40px;">家長 :</label>
        <input type="text" id="parentName" name="parentName" oninput="checkInputs()" style="width: calc(100% - 40px);">
    </div>
    <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
        <label for="invoiceNumber" style="width: 40px;">單號 :</label>
        <input type="text" id="invoiceNumber" name="invoiceNumber" oninput="checkInputs()" style="width: calc(100% - 40px);">
    </div>
</form>

                
                <div id="optitleoutput"></div>
                <button id="copyButton" onclick="copyText()" style="font-size: 12px;">複製標題</button>
<hr>

<!-- IP 地址、暫存隱藏
<form id="ipForm" onsubmit="return lookupIP()">
    <label for="ipAddress">IP-ISP查詢：</label>
    <input type="text" id="ipAddress" name="ipAddress" required>
    <button type="submit">查詢</button>
</form>
<div id="result"></div>
<br>
<textarea id="myTextArea" rows="4" cols="22" style="width: 380px; height: 88px;" onclick="clearWatermark()">在這裡輸入文字...</textarea>
<br>
                    -->
<!--南一id查詢-->
<iframe id="usersearch" src="userlogframe_left.html"></iframe>
    <br>
<!--教室Log查詢-->
 <iframe id="logsearch" src="userlogframe_right.html"></iframe>
<div>
            </td>
    <td style="width: 10px;"></td>

            <td class="right">
<div class="RightPanel">
                <input type="checkbox" id="toggleCheckbox">
                <label for="toggleCheckbox">顧問組別清單</label>
                <div id="content">
                    <iframe class="responsive-iframe" src="SA_iframe.html"></iframe>
                </div>
</div
            </td>
        </tr>
    </table>


<script>
// 檔次複製成功的紅色提示
function copyToClipboard(text) {
    var copyMessage = document.getElementById('copyMessage');
    copyMessage.textContent = '檔次已複製【' + text + '】';

    var textarea = document.createElement('textarea');
    textarea.value = text;
    document.body.appendChild(textarea);
    textarea.select();
    document.execCommand('copy');
    document.body.removeChild(textarea);

    setTimeout(function() {
        copyMessage.textContent = '　';
    }, 5000);
}
// 函數複製成功的紅色提示
function copyToClipboard_F12script(text, message) {
    var copyMessage = document.getElementById('copyMessage');
    copyMessage.textContent = message;

    var textarea = document.createElement('textarea');
    textarea.value = text;
    document.body.appendChild(textarea);
    textarea.select();
    document.execCommand('copy');
    document.body.removeChild(textarea);

    setTimeout(function() {
        copyMessage.textContent = '　';
    }, 5000);
}
// 標題生成，輸入框有值生成文本，空時清除輸出
function checkInputs() {
    var consultantName = document.getElementById("consultantName").value.replace(/\s/g, '');
    var studentName = document.getElementById("studentName").value.replace(/\s/g, '');
    var parentName = document.getElementById("parentName").value.replace(/\s/g, '');
    var invoiceNumber = document.getElementById("invoiceNumber").value.replace(/[#\s]/g, '');
    
    if (consultantName !== '' || studentName !== '' || parentName !== '' || invoiceNumber !== '') {
        generateText();
    } else {
        clearOutput(); // 當所有輸入框都為空時清除輸出內容
    }
}
// 將上面的標題組合成固定格式，並清除空白鍵及單號中的井字
function generateText() {
    var consultantName = document.getElementById("consultantName").value.replace(/\s/g, '');
    var studentName = document.getElementById("studentName").value.replace(/\s/g, '');
    var parentName = document.getElementById("parentName").value.replace(/\s/g, '');
    var invoiceNumber = document.getElementById("invoiceNumber").value.replace(/[#\s]/g, '');
    
    var outputText = "[顧問 " + consultantName + "] " + studentName + " / " + parentName;

    if (invoiceNumber !== '') {
        outputText += " #" + invoiceNumber;
    }

    document.getElementById("optitleoutput").innerText = outputText;
}

function clearOutput() {
    document.getElementById("optitleoutput").innerText = "";
}

// 清除指定的輸入欄位
function clearFields() {
    document.getElementById("consultantName").value = "";
    document.getElementById("studentName").value = "";
    document.getElementById("parentName").value = "";
    document.getElementById("invoiceNumber").value = "";
    clearOutput(); // 清除輸出內容
}
// 複製生成好的標題 按鈕樣式
function copyText() {
    var textToCopy = document.getElementById("optitleoutput").innerText;
    var tempInput = document.createElement("input");
    tempInput.value = textToCopy;
    document.body.appendChild(tempInput);
    tempInput.select();
    document.execCommand("copy");
    document.body.removeChild(tempInput);

    // 將按鈕文字設置為已複製
    var copyButton = document.getElementById("copyButton");
    copyButton.innerText = "已複製";
    copyButton.classList.add("unclickable"); // 添加不可選取的樣式

    // 三秒後恢復按鈕為可選取
    setTimeout(function() {
        copyButton.innerText = "複製標題";
        copyButton.classList.remove("unclickable"); // 移除不可選取的樣式
    }, 3000);
}

// 查找IP服務商函數
function lookupIP() {
    var ipAddress = document.getElementById('ipAddress').value;
    var url = 'https://api.ipgeolocation.io/ipgeo?apiKey=204b59bb7d49446b849d25499a5f6aee&ip=' + ipAddress;

    fetch(url)
        .then(response => response.json())
        .then(data => {
            var resultDiv = document.getElementById('result');
            resultDiv.innerHTML = '<h3>查詢結果：</h3>' +
                                  'IP 地址：' + data.ip + '<br>' +
                                  '國家：' + data.country_name + '<br>' +
                                  '城市：' + data.city + '<br>' +
                                  'ISP：' + data.isp + '<br>';
        })
        .catch(error => {
            console.error('Error:', error);
            var resultDiv = document.getElementById('result');
            resultDiv.innerHTML = '<p>查詢失敗。請檢查輸入的 IP 地址並重試。</p>';
        });

    return false; // 防止表單提交
}
//自由輸入欄的函數
function clearWatermark() {
    var textarea = document.getElementById("myTextArea");
    if (textarea.value === "在這裡輸入文字...") {
        textarea.value = "";
    }
}
// 清空檔次提示語函數
document.addEventListener("DOMContentLoaded", function() {
    var copyMessage = document.getElementById('copyMessage');
    copyMessage.textContent = '　';
});

//顧問名單googlesheet勾選腳本
document.getElementById('toggleCheckbox').addEventListener('change', function() {
    const content = document.getElementById('content');
    if (this.checked) {
        content.style.display = 'block';
    } else {
        content.style.display = 'none';
    }
});
</script>
</body>
</html>
