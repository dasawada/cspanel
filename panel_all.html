
<html lang="zh-Hant">
<head>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-1638R1H1FB"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-1638R1H1FB');
</script>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>★客服小工具ALL★</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<link rel="stylesheet" href="font.css">
<link rel="stylesheet" href="font.css">
<link rel="stylesheet" href="body.css">
<link rel="stylesheet" href="button.css">
</head>
<body>
<div class="update-header">※版本更新：
<a href="https://dasawada.github.io/cspanel/updatenote.txt" target="_blank">2024/06/28</a></div>
<div class="container">
<div class="roofbutton">
<button onclick="copyToClipboard('OneClass真人Live家教_體驗接待大廳_A')">LINE大廳A</button>
<button onclick="copyToClipboard('OneClass真人Live家教_官方臉書_A')">FB_A</button>
<button onclick="copyToClipboard('直播公開課_A')">直播_A</button>
<button onclick="copyToClipboard('電話進線_A')">電話進線_A</button>
<button onclick="copyToClipboard('2024年XX月_MGM名單_B')">MGM_B</button>
<p>
<button class="DienMing" onclick="copyToClipboard_F12script('\
// 老師點名\n\
function showRows() {\n\
    // 選擇所有具有類名 .MuiTableRow-root 的元素\n\
    var rows = document.querySelectorAll(\'.MuiTableRow-root\');\n\
    // 遍歷每個行元素\n\
    rows.forEach(function(row) {\n\
        var cells = row.querySelectorAll(\'.MuiTableCell-root\');\n\
        var shouldShowRow = false;\n\
        // 檢查每個單元格中的內容\n\
        cells.forEach(function(cell) {\n\
            // 在每個單元格元素中查找是否存在類名為 .MuiBox-root.css-1v9l4og 的子元素\n\
            var box1 = cell.querySelector(\'.MuiBox-root.css-1v9l4og\');\n\
            // 在每個單元格元素中查找是否存在類名為 .MuiBox-root.css-1tqg586 的子元素\n\
            var box2 = cell.querySelector(\'.MuiBox-root.css-1tqg586\');\n\
            // 如果找到了符合條件的子元素，且第二個子元素沒有其他子元素\n\
            if (box1 && box2 && !box2.querySelector(\'.MuiBox-root\')) {\n\
                shouldShowRow = true;\n\
            }\n\
        });\n\
        // 根據 shouldShowRow 的值顯示或隱藏整行\n\
        row.style.display = shouldShowRow ? \'table-row\' : \'none\';\n\
    });\n\
}\n\
// 在延遲1秒後執行顯示/隱藏行的函數\n\
setTimeout(showRows, 1000);\n\
', '【點名】函數已複製')">點名</button>

<button class="deactiveDienMing" onclick="copyToClipboard_F12script('\
// 解除點名\n\
function showAllRows() {\n\
    // 選擇所有具有類名 .MuiTableRow-root 的元素\n\
    var rows = document.querySelectorAll(\'.MuiTableRow-root\');\n\
    // 將所有行顯示\n\
    rows.forEach(function(row) {\n\
        row.style.display = \'\'; // 設置為空字符串，以使用默認的顯示方式\n\
    });\n\
}\n\
// 在延遲1秒後執行完全顯示所有行的函數\n\
setTimeout(showAllRows, 1000);\n\
', '【解除點名】函數已複製')">解除點名</button>
<button onclick="copyToClipboard_F12script('老師您好，現在的課程您還沒有進教室喔，請問有發生什麼狀況需要協助嗎？', '【老師未到】話術已複製')" >老師未到</button>
<button onclick="copyToClipboard_F12script('查看老師已進入教室了，再麻煩老師補足上課時數哦，謝謝老師！', '【補足時數】話術已複製')" >補足時數</button>
</p>
<div id="copyMessage"></div>
</div>
<div class="spacer"></div>
            <div class="optitlepanel">
                <form id="consultantForm" style="margin: 0;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 5px;">
                        <b>OP標題生成</b>
                        <button type="button" onclick="clearFields()" style="font-size: 12px;">清空欄位</button>
                    </div>
		<div class="op-title-output-div">
                    <span class="optitle-text-form">[顧問</span>
                    <label style="position: relative; display: inline-block; cursor: text;">
                        <input type="text" id="consultantName" name="consultantName" class="optitle-input" oninput="search()" style="width: 70px;">
                        <span class="optitle-placeholder" style="position: absolute; right: 5px; top: 50%; transform: translateY(-50%); color: #999; pointer-events: none;">顧問姓名</span>
                    </label>
                    <span class="optitle-text-form">]</span>
                    <label style="position: relative; display: inline-block; cursor: text;">
                        <input type="text" id="studentName" name="studentName" class="optitle-input" oninput="checkInputs()" style="width: 85px;">
                        <span class="optitle-placeholder" style="position: absolute; right: 5px; top: 50%; transform: translateY(-50%); color: #999; pointer-events: none;">學生姓名</span>
                    </label>
                    <span class="optitle-text-form">/</span>
                    <label style="position: relative; display: inline-block; cursor: text;">
                        <input type="text" id="parentName" name="parentName" class="optitle-input" oninput="checkInputs()" style="width: 85px;">
                        <span class="optitle-placeholder" style="position: absolute; right: 5px; top: 50%; transform: translateY(-50%); color: #999; pointer-events: none;">家長姓名</span>
                    </label>
                    <span class="optitle-text-form">#</span>
                    <label style="position: relative; display: inline-block; cursor: text;">
                        <input type="text" id="invoiceNumber" name="invoiceNumber" class="optitle-input" oninput="checkInputs()" style="width: 80px;">
                        <span class="optitle-placeholder" style="position: absolute; right: 5px; top: 50%; transform: translateY(-50%); color: #999; pointer-events: none;">單號</span>
                    </label>
                </form>
				<div class="spacer"></div>
                <span id="optitleoutput">生成的標題會顯示在這裡٩(๑❛ᴗ❛๑)۶</span>
                <button id="copyButton" onclick="copyText()" style="font-size: 12px;">複製標題</button>
		    </div>
		<span id="search_SAWHO_ResultsSpan"></span>
		<div id="search_SAWHO_ResultsDiv"></div>

            </div>
            <div class="spacer"></div>
            <div class="idsearchpanel">
                <iframe id="usersearch" src="userlogframe_left.html"></iframe>
            </div>
            <div class="spacer"></div>
            <div class="ClassLogpanel">
                <iframe id="logsearch" src="userlogframe_right.html"></iframe>
            </div>
        <div class="spacer"></div>
<div class="consultantlistgooglesheet">
    <div class="toggle-container">
        <input type="checkbox" id="toggleCheckbox">
        <label for="toggleCheckbox">顧問組別清單</label>
    </div>
            <div id="content" style="display: none;">
                <iframe class="responsive-iframe" src="SA_iframe.html"></iframe>
            </div>
        </div>
<div class="linkout">

    <div class="input-container">
        <input type="text" id="longUrl" placeholder="輸入網址">
        <button id="shortenButton" onclick="shortenUrlIsGd()">製作短網址</button>
    </div>
    <div id="shortUrlContainer">
        <input type="text" id="shortUrlOutput" placeholder="此處將顯示【is.gd】短網址" readonly>
        <button id="shortencpbt" onclick="copyShortUrlToClipboard()">Copy</button>
    </div>
</div>
    <div class="appicon">
        點擊圖片自動複製，可直接貼至BX<br>
        <img id="chromeIcon" src="chrome_icon.png" alt="Copy Icon" width="60" height="60">
        <img id="safariIcon" src="safari_icon.png" alt="Copy Icon" width="60" height="60">
        <img id="chromeRefreshIcon" src="chrome_refresh.png" alt="Copy Icon" width="60" height="60">
        <img id="chromeaAccessIcon" src="chrome_access.png" alt="Copy Icon" width="60" height="60">
        <br>
        功能禁用圖庫
        <br>
        <img id="camDisableIcon" src="cam_disable.png" alt="Copy Icon" width="60">
        <img id="micDisableIcon" src="mic_disable.png" alt="Copy Icon" width="60">
        <img id="spDisableIcon" src="sp_disable.png" alt="Copy Icon" width="60">
        <br>
        macbook快速鍵
        <br>
        <img id="macMicIcon" src="mac_mic.png" alt="Copy Icon" width="60">
        <img id="macSpeakerIcon" src="mac_speaker.png" alt="Copy Icon" width="180">
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', (event) => {
            document.querySelector('.appicon').addEventListener('click', function(e) {
                if (e.target && e.target.tagName === 'IMG') {
                    copyImageToClipboard(e.target.id);
                }
            });

            async function copyImageToClipboard(imageId) {
                try {
                    // 獲取img URL
                    const imgURL = document.getElementById(imageId).src;

                    // fetch拿圖片Blob
                    const response = await fetch(imgURL);
                    if (!response.ok) {
                        throw new Error('無回應');
                    }
                    const blob = await response.blob();

                    // 建立ClipboardItem並貼到剪貼簿
                    const clipboardItem = new ClipboardItem({ [blob.type]: blob });
                    await navigator.clipboard.write([clipboardItem]);

                    console.log('圖片已複製');
                } catch (error) {
                    console.error('複製圖片時剪貼簿出錯: ', error);
                }
            }

            // 請剪貼簿權限
            if (navigator.permissions) {
                navigator.permissions.query({ name: 'clipboard-write' }).then(result => {
                    if (result.state === 'granted') {
                        console.log('剪貼簿寫入權限GET');
                    } else if (result.state === 'prompt') {
                        console.log('剪貼簿寫入權限 待接受');
                    } else {
                        console.log('無剪貼簿使用權');
                    }
                });
            }
        });
function copyToClipboard(text) {
    var copyMessage = document.getElementById('copyMessage');
    copyMessage.textContent = '檔次已複製【' + text + '】';
    copyMessage.classList.remove('hidden'); // 顯示消息

    // 移除並重新添加 fade-out 類以重置動畫
    copyMessage.classList.remove('fade-out');
    void copyMessage.offsetWidth; // 觸發重排
    copyMessage.classList.add('fade-out');

    var textarea = document.createElement('textarea');
    textarea.value = text;
    document.body.appendChild(textarea);
    textarea.select();
    document.execCommand('copy');
    document.body.removeChild(textarea);

    setTimeout(function() {
        copyMessage.classList.add('hidden'); // 動畫結束後隱藏
    }, 4000); // 與動畫持續時間匹配
}

function copyToClipboard_F12script(text, message) {
    var copyMessage = document.getElementById('copyMessage');
    copyMessage.textContent = message;
    copyMessage.classList.remove('hidden'); // 顯示消息

    // 移除並重新添加 fade-out 類以重置動畫
    copyMessage.classList.remove('fade-out');
    void copyMessage.offsetWidth; // 觸發重排
    copyMessage.classList.add('fade-out');

    var textarea = document.createElement('textarea');
    textarea.value = text;
    document.body.appendChild(textarea);
    textarea.select();
    document.execCommand('copy');
    document.body.removeChild(textarea);

    setTimeout(function() {
        copyMessage.classList.add('hidden'); // 動畫結束後隱藏
    }, 4000); // 與動畫持續時間匹配
}

// 標題生成的浮水印
        document.querySelectorAll('.optitle-input').forEach(input => {
            const placeholder = input.nextElementSibling;
            if (input.value) {
                placeholder.style.visibility = 'hidden';
            }
            input.addEventListener('focus', () => {
                placeholder.style.visibility = 'hidden';
            });
            input.addEventListener('blur', () => {
                if (!input.value) {
                    placeholder.style.visibility = 'visible';
                }
            });
            input.addEventListener('input', () => {
                if (input.value) {
                    placeholder.style.visibility = 'hidden';
                } else {
                    placeholder.style.visibility = 'visible';
                }
            });
        });

// 標題生成，輸入框有值生成文本，空時清除輸出
function checkInputs() {
    var consultantName = document.getElementById("consultantName").value.replace(/\s/g, '');
    var studentName = document.getElementById("studentName").value.replace(/\s/g, '');
    var parentName = document.getElementById("parentName").value.replace(/\s/g, '');
    var invoiceNumber = document.getElementById("invoiceNumber").value.replace(/[#\s]/g, '');

    if (consultantName !== '' || studentName !== '' || parentName !== '' || invoiceNumber !== '') {
        generateText();
    } else {
        clearOutput(); // 當所有輸入框都為空時清除輸出內容
    }
}
// 將上面的標題組合成固定格式，並清除空白鍵及單號中的井字
function generateText() {
    var consultantName = document.getElementById("consultantName").value.replace(/\s/g, '');
    var studentName = document.getElementById("studentName").value.replace(/\s/g, '');
    var parentName = document.getElementById("parentName").value.replace(/\s/g, '');
    var invoiceNumber = document.getElementById("invoiceNumber").value.replace(/[#\s]/g, '');
    
    var outputText = "[顧問 " + consultantName + "] " + studentName;

    // 確保學生+家長皆有出現才加斜線
    if (studentName !== '' && parentName !== '') {
        outputText += " / " + parentName;
    } else {
        outputText += parentName;
    }
    // 有單號才顯示井號
    if (invoiceNumber !== '') {
        outputText += " #" + invoiceNumber;
    }
    // 獲取並顯示標題
    document.getElementById("optitleoutput").innerText = outputText;
}
// input 無值時清除標題
function clearOutput() {
    document.getElementById("optitleoutput").innerText = "";
}

// 清除指定的輸入欄位
function clearFields() {
    document.getElementById("consultantName").value = "";
    document.getElementById("studentName").value = "";
    document.getElementById("parentName").value = "";
    document.getElementById("invoiceNumber").value = "";
    clearOutput(); // 清除輸出內容
    search();
}

// 檢查輸入框值，並生成或清除輸出
function checkInputs() {
    var consultantName = document.getElementById("consultantName").value.replace(/\s/g, '');
    var studentName = document.getElementById("studentName").value.replace(/\s/g, '');
    var parentName = document.getElementById("parentName").value.replace(/\s/g, '');
    var invoiceNumber = document.getElementById("invoiceNumber").value.replace(/[#\s]/g, '');

    if (consultantName !== '' || studentName !== '' || parentName !== '' || invoiceNumber !== '') {
        generateText();
    } else {
        clearOutput(); // 當所有輸入框都為空時清除輸出內容
    }
}


const sheetId = "1FcjzaPWepGLRwdwyyefvZs_HEXhC168MircYGqpV9eQ";
const apiKey = "AIzaSyAACAPVwRkK2Ii1nc8oJ8q0ha1ZF3gHlQU";
const endpoint = `https://sheets.googleapis.com/v4/spreadsheets/${sheetId}/values/顧問組別清單?key=${apiKey}`;

// search 函數只處理 consultantName
function search() {
    var searchString = document.getElementById('consultantName').value.replace(/\s+/g, '');

    if (searchString === '') {
        const searchResultsDiv = document.getElementById('search_SAWHO_ResultsDiv');
        const searchResultsSpan = document.getElementById('search_SAWHO_ResultsSpan');
        if (searchResultsDiv) {
            searchResultsDiv.innerHTML = '';
        }
        if (searchResultsSpan) {
            searchResultsSpan.innerHTML = '';
        }
        clearOutput(); // 清除輸出內容
        return;
    }

    // 始终生成文本
    generateText();
	
    $.get(endpoint, function(response) {
        console.log(response);

        const search_SAWHO_ResultsSpan = document.getElementById('search_SAWHO_ResultsSpan');
        const search_SAWHO_ResultsDiv = document.getElementById('search_SAWHO_ResultsDiv');

        search_SAWHO_ResultsSpan.innerHTML = '';
        search_SAWHO_ResultsDiv.innerHTML = '';

        let found = false;
        for (let rowIndex = 0; rowIndex < response.values.length; rowIndex++) {
            for (let columnIndex = 0; columnIndex < response.values[rowIndex].length; columnIndex++) {
                const cellValue = response.values[rowIndex][columnIndex].replace(/\s+/g, '').toLowerCase(); // 去除所有單元格內的空白字符
                if (cellValue === searchString.toLowerCase()) {
                    const resultColumnIdentifier = String.fromCharCode('A'.charCodeAt(0) + columnIndex);
                    const teamLeaderRow = 3;
                    const teamRow = teamLeaderRow - 1;

                    const teamLeaderValue = response.values[teamLeaderRow][columnIndex];
                    const teamValue = response.values[teamRow][columnIndex];

                    const p = document.createElement('p');
                    p.textContent = `組長：${teamLeaderValue}（${teamValue}）`;
                    
                    const span = document.createElement('span');
                    span.textContent = `組長：${teamLeaderValue}`;
                    span.style.cursor = 'pointer';
                    span.title = '點我一下複製名字';

                    span.addEventListener('click', function() {
                        const tempInput = document.createElement('input');
                        tempInput.value = teamLeaderValue;
                        document.body.appendChild(tempInput);
                        tempInput.select();
                        document.execCommand('copy');
                        document.body.removeChild(tempInput);
                        span.title = '已複製！';
                    });

                    p.textContent = ''; // 清空p元素内容
                    p.appendChild(span);
                    p.appendChild(document.createTextNode(`（team：${teamValue}）`)); // 加入team訊息

                    search_SAWHO_ResultsSpan.appendChild(p);

                    found = true;
                    break;
                }
            }
            if (found) {
                break;
            }
        }

        if (!found) {
            const p = document.createElement('p');
            p.textContent = `【${searchString}】這個顧問找不到組長唷ఠ_ఠ`;
            search_SAWHO_ResultsDiv.appendChild(p);
        }
    });
}
	    
// 複製生成好的標題 按鈕樣式
function copyText() {
    event.preventDefault();
    var textToCopy = document.getElementById("optitleoutput").innerText;
    var tempInput = document.createElement("input");
    tempInput.value = textToCopy;
    document.body.appendChild(tempInput);
    tempInput.select();
    document.execCommand("copy");
    document.body.removeChild(tempInput);

    // 將按鈕文字設置為已複製
    var copyButton = document.getElementById("copyButton");
    copyButton.innerText = "已複製";
    copyButton.classList.add("unclickable"); // 按鈕不可選取

    // 三秒後恢復按鈕為可選取
    setTimeout(function() {
        copyButton.innerText = "複製標題";
        copyButton.classList.remove("unclickable"); // 取消按鈕不可選取
    }, 3000);
}

// 查找IP服務商函數
function lookupIP() {
    var ipAddress = document.getElementById('ipAddress').value;
    var url = 'https://api.ipgeolocation.io/ipgeo?apiKey=204b59bb7d49446b849d25499a5f6aee&ip=' + ipAddress;

    fetch(url)
        .then(response => response.json())
        .then(data => {
            var resultDiv = document.getElementById('result');
            resultDiv.innerHTML = '<h3>查詢結果：</h3>' +
                                  'IP 地址：' + data.ip + '<br>' +
                                  '國家：' + data.country_name + '<br>' +
                                  '城市：' + data.city + '<br>' +
                                  'ISP：' + data.isp + '<br>';
        })
        .catch(error => {
            console.error('Error:', error);
            var resultDiv = document.getElementById('result');
            resultDiv.innerHTML = '<p>查詢失敗。請檢查輸入的 IP 地址並重試。</p>';
        });

    return false; // 防止表單提交
}
//自由輸入欄的函數
function clearWatermark() {
    var textarea = document.getElementById("myTextArea");
    if (textarea.value === "在這裡輸入文字...") {
        textarea.value = "";
    }
}
// 清空檔次提示語函數
document.addEventListener("DOMContentLoaded", function() {
    var copyMessage = document.getElementById('copyMessage');
    copyMessage.textContent = '　';
});

// 顧問名單googlesheet勾選腳本
document.getElementById('toggleCheckbox').addEventListener('change', function() {
    const content = document.getElementById('content');
    const container = document.querySelector('.consultantlistgooglesheet');
    if (this.checked) {
        container.classList.remove('small-size');
        content.style.display = 'block';
    } else {
        container.classList.add('small-size');
        content.style.display = 'none';
    }
});

// 頁面載入時初始化
window.addEventListener('DOMContentLoaded', (event) => {
    const container = document.querySelector('.consultantlistgooglesheet');
    const content = document.getElementById('content');
    const checkbox = document.getElementById('toggleCheckbox');

    // 頁面載入時預設未勾選並顯示小尺寸
    checkbox.checked = false;
    container.classList.add('small-size');
    content.style.display = 'none';
});


async function copyShortUrlToClipboard() {
    const shortUrlOutput = document.getElementById('shortUrlOutput');
    shortUrlOutput.select();
    shortUrlOutput.setSelectionRange(0, 99999); // For mobile devices

    try {
        document.execCommand('copy');
        showCopyButtonMessage('Copied!');
    } catch (err) {
        showCopyButtonMessage('Oops, unable to copy');
    }
}

function showCopyButtonMessage(message) {
    const copyButton = document.getElementById('shortencpbt');
    copyButton.textContent = message;

    setTimeout(() => {
        copyButton.textContent = 'Copy';
    }, 2000); // 2秒後重置按鈕文本
}
</script>
</body>
</html>
