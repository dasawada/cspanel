<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Google Sheets 搜尋功能</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
</head>
<body>

<h1>Google Sheets 搜尋功能</h1>

<input type="text" id="searchInput" placeholder="輸入要搜索的值">
<button onclick="search()">搜索</button>

<div id="searchResults"></div>

<script>
// Google Sheets API 相关信息
const sheetId = "1FcjzaPWepGLRwdwyyefvZs_HEXhC168MircYGqpV9eQ";
const apiKey = "AIzaSyAACAPVwRkK2Ii1nc8oJ8q0ha1ZF3gHlQU";
const endpoint = `https://sheets.googleapis.com/v4/spreadsheets/${sheetId}/values/顧問組別清單?key=${apiKey}`;

// 定义搜索函数
function search() {
    const searchString = document.getElementById('searchInput').value.trim().toLowerCase();

    // 使用 jQuery 发送 GET 请求获取数据
    $.get(endpoint, function(response) {
        console.log(response);

        // 清空之前的搜索结果
        const searchResultsDiv = document.getElementById('searchResults');
        searchResultsDiv.innerHTML = '';

        // 假设 searchString 是待搜索的名称，response 是从 Google Sheets API 返回的数据
        const values = response.values;

        // 在这里编写处理搜索结果的逻辑
        // 例如，根据搜索结果展示数据或其他操作

        // 以下是一个示例
        const p = document.createElement('p');
        p.textContent = `搜索结果为：${searchString}`;
        searchResultsDiv.appendChild(p);
    });
}
</script>

</body>
</html>
