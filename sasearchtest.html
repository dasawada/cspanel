<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>查找組長</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
</head>
<body>

<h1>查找組長</h1>

<input type="text" id="memberNameInput" placeholder="輸入組員姓名">
<button onclick="findTeamLeader()">查找組長1</button>

<div id="searchResults"></div>

<script>
// Google Sheets API 相关信息
const sheetId = "1FcjzaPWepGLRwdwyyefvZs_HEXhC168MircYGqpV9eQ";
const apiKey = "AIzaSyAACAPVwRkK2Ii1nc8oJ8q0ha1ZF3gHlQU";
const endpoint = `https://sheets.googleapis.com/v4/spreadsheets/${sheetId}/values/顧問組別清單?key=${apiKey}`;

// 搜尋功能函數
function searchForMember(memberName) {
    // 使用 jQuery 發送 GET 請求來取得資料
    $.get(endpoint, function(response) {
        console.log(response);

        // 清空之前的搜尋結果
        const searchResultsDiv = document.getElementById('searchResults');
        searchResultsDiv.innerHTML = '';

        // 假设 response 是从 Google Sheets API 返回的数据对象
        const values = response.values;

        // 遍历每个组别，查找成员名字是否存在
        for (let columnIndex = 0; columnIndex < values[0].length; columnIndex++) {
            // 获取组别标识，例如 A, B, C, ...
            const columnIdentifier = String.fromCharCode('A'.charCodeAt(0) + columnIndex);

            // 获取第四行的值，即每个组别的组长名字
            const teamLeader = values[3][columnIndex]; // 第四行数据，索引为 3

            // 遍历该组别的成员行，从第五行开始，即 A4, A5, A6, ... 直到 A99
            for (let rowIndex = 4; rowIndex < values.length; rowIndex++) {
                // 获取当前单元格的值，成员名字
                const cellValue = values[rowIndex][columnIndex].trim().toLowerCase();

                // 如果找到对应的成员名字
                if (cellValue === memberName.trim().toLowerCase()) {
                    // 输出结果
                    console.log(`For ${memberName}, team identifier is ${columnIdentifier} and team leader is ${teamLeader}`);

                    // 在页面上显示结果
                    const p = document.createElement('p');
                    p.textContent = `For ${memberName}, team identifier is ${columnIdentifier} and team leader is ${teamLeader}`;
                    searchResultsDiv.appendChild(p);

                    // 结束循环，因为找到了结果
                    return;
                }
            }
        }

        // 如果未找到匹配的成员名字
        console.log(`No match found for ${memberName}`);

        // 在页面上显示未找到结果
        const p = document.createElement('p');
        p.textContent = `No match found for ${memberName}`;
        searchResultsDiv.appendChild(p);
    });
}

</script>

</body>
</html>
