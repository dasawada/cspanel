<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Google Sheets 搜尋組長功能</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
</head>
<body>

<h1>Google Sheets 搜尋組長功能</h1>

<input type="text" id="searchInput" placeholder="輸入要搜索的組員名稱">
<button onclick="search()">搜索1</button>

<div id="searchResults"></div>

<script>
// Google Sheets API 相关信息
const sheetId = "1FcjzaPWepGLRwdwyyefvZs_HEXhC168MircYGqpV9eQ";
const apiKey = "AIzaSyAACAPVwRkK2Ii1nc8oJ8q0ha1ZF3gHlQU";
const endpoint = `https://sheets.googleapis.com/v4/spreadsheets/${sheetId}/values/顧問組別清單?key=${apiKey}`;

// 搜索功能函数
function findTeamMembersOfLeader(leaderName) {
    const leader = leaderName.toLowerCase();

    // 使用 jQuery 发送 GET 请求获取数据
    $.get(endpoint, function(response) {
        console.log(response);

        // 假设 response 是从 Google Sheets API 返回的数据对象
        const values = response.values;

        // 寻找匹配的组长索引
        let columnIndex = -1;
        const leaderRow = values[3]; // 第四行数据，组长信息
        if (leaderRow) {
            columnIndex = leaderRow.findIndex(cell => cell.trim().toLowerCase() === leader);
        }

        // 如果找到匹配的组长
        if (columnIndex !== -1) {
            // 遍历所有行，收集该组长的组员
            let teamMembers = [];
            for (let row = 4; row < values.length; row++) {
                if (values[row][columnIndex]) {
                    teamMembers.push(values[row][columnIndex]);
                }
            }

            // 输出结果
            console.log(`Team members of ${leaderName}: ${teamMembers.join(', ')}`);
            alert(`Team members of ${leaderName}: ${teamMembers.join(', ')}`);
        } else {
            console.log(`No team leader found for ${leaderName}`);
            alert(`No team leader found for ${leaderName}`);
        }
    });
}

// 调用函数查找
findTeamMembersOfLeader('林晉雍');
</script>


</body>
</html>
