<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>查找組長</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
</head>
<body>

<h1>查找組長</h1>

<input type="text" id="memberNameInput" placeholder="輸入組員姓名">
<button onclick="findTeamLeader()">查找組長</button>

<div id="searchResults"></div>

<script>
// Google Sheets API 相关信息
const sheetId = "1FcjzaPWepGLRwdwyyefvZs_HEXhC168MircYGqpV9eQ";
const apiKey = "AIzaSyAACAPVwRkK2Ii1nc8oJ8q0ha1ZF3gHlQU";
const endpoint = `https://sheets.googleapis.com/v4/spreadsheets/${sheetId}/values/顧問組別清單?key=${apiKey}`;

// 查找功能函数
function findTeamLeader() {
    const memberName = document.getElementById('memberNameInput').value.trim(); // 获取输入的组员姓名

    // 使用 jQuery 发送 GET 请求获取数据
    $.get(endpoint, function(response) {
        console.log(response);

        // 假设 response 是从 Google Sheets API 返回的数据对象
        const values = response.values;

        // 查找匹配的组员所在列索引
        let rowIndex = -1;
        for (let row = 4; row < values.length; row++) {
            const memberRow = values[row]; // 每一行的数据，从第五行开始，索引从 4 开始
            if (memberRow) {
                const columnIndex = memberRow.findIndex(cell => cell.trim().toLowerCase() === memberName.toLowerCase());
                if (columnIndex !== -1) {
                    rowIndex = row;
                    break;
                }
            }
        }

        // 如果找到匹配的组员所在列索引
        if (rowIndex !== -1) {
            // 获取对应列的组长
            const teamLeader = values[3][rowIndex]; // 第四行数据，索引为 3

            // 输出结果到页面
            const searchResultsDiv = document.getElementById('searchResults');
            searchResultsDiv.innerHTML = '';

            const resultHeading = document.createElement('h2');
            resultHeading.textContent = `${memberName} 的組長是：`;
            searchResultsDiv.appendChild(resultHeading);

            const leaderInfo = document.createElement('p');
            leaderInfo.textContent = teamLeader;
            searchResultsDiv.appendChild(leaderInfo);
        } else {
            // 如果未找到匹配的组员
            const searchResultsDiv = document.getElementById('searchResults');
            searchResultsDiv.innerHTML = '';

            const noResults = document.createElement('p');
            noResults.textContent = `未找到組員 ${memberName}。`;
            searchResultsDiv.appendChild(noResults);
        }
    });
}
</script>

</body>
</html>
