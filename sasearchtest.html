<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>查找組長</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
</head>
<body>

<h1>查找組長</h1>

<input type="text" id="memberNameInput" placeholder="輸入組員姓名">
<button onclick="findTeamLeader()">查找組長</button>

<div id="searchResults"></div>

<script>
// Google Sheets API 相关信息
const sheetId = "1FcjzaPWepGLRwdwyyefvZs_HEXhC168MircYGqpV9eQ";
const apiKey = "AIzaSyAACAPVwRkK2Ii1nc8oJ8q0ha1ZF3gHlQU";
const endpoint = `https://sheets.googleapis.com/v4/spreadsheets/${sheetId}/values/顧問組別清單?key=${apiKey}`;

// 定義查找組長的函數
function findTeamLeader() {
    const memberName = document.getElementById('memberNameInput').value.trim().toLowerCase();

    // 使用 jQuery 發送 GET 請求來取得數據
    $.get(endpoint, function(response) {
        console.log(response);

        // 假設 response 是從 Google Sheets API 返回的數據
        const values = response.values;

        // 寻找匹配的列索引
        let columnIndex = -1;
        const memberRow = values[4]; // 假设第五行是成员行，索引为 4
        if (memberRow && memberRow.length > 0) {
            columnIndex = memberRow.findIndex(cell => cell.trim().toLowerCase() === memberName);
        }

        // 如果找到匹配的列索引
        if (columnIndex !== -1) {
            // 获取组别标识和对应的组长
            const teamIdentifier = values[1][columnIndex];
            const teamLeader = values[3][columnIndex]; // 假设第四行是组长行，索引为 3

            // 输出结果
            console.log(`For ${memberName}, team identifier is ${teamIdentifier} and team leader is ${teamLeader}`);

            // 在页面上显示结果
            const searchResultsDiv = document.getElementById('searchResults');
            searchResultsDiv.innerHTML = '';

            const p = document.createElement('p');
            p.textContent = `For ${memberName}, team identifier is ${teamIdentifier} and team leader is ${teamLeader}`;
            searchResultsDiv.appendChild(p);
        } else {
            // 如果未找到匹配的列索引
            console.log(`No match found for ${memberName}`);

            // 在页面上显示未找到结果
            const searchResultsDiv = document.getElementById('searchResults');
            searchResultsDiv.innerHTML = '';

            const p = document.createElement('p');
            p.textContent = `No match found for ${memberName}`;
            searchResultsDiv.appendChild(p);
        }
    });
}
</script>

</body>
</html>
