<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>查找組長</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
</head>
<body>

<h1>查找組長</h1>

<input type="text" id="memberNameInput" placeholder="輸入組員姓名">
<button onclick="findTeamLeader()">查找組長</button>

<div id="searchResults"></div>

<script>
// 示例：搜索特定成员的组长信息
function searchForMember(memberName) {
    const sheetId = "1FcjzaPWepGLRwdwyyefvZs_HEXhC168MircYGqpV9eQ";
    const apiKey = "AIzaSyAACAPVwRkK2Ii1nc8oJ8q0ha1ZF3gHlQU";
    const endpoint = `https://sheets.googleapis.com/v4/spreadsheets/${sheetId}/values/顧問組別清單?key=${apiKey}`;

    // 使用 jQuery 发送 GET 请求获取数据
    $.get(endpoint, function(response) {
        console.log(response);

        // 假设 response 是从 Google Sheets API 返回的数据对象
        const values = response.values;

        // 寻找成员的位置，假设成员名称在 B4 到 B99 之间
        let columnIndex = -1;
        for (let i = 3; i < 100; i++) { // 假设 B4 到 B99 的列范围
            const cellValue = values[i][1].trim().toLowerCase(); // 假设成员姓名在第二列（索引为 1）
            if (cellValue === memberName.toLowerCase()) {
                columnIndex = i - 3; // 转换为从 0 开始的列索引
                break;
            }
        }

        // 如果找到成员的位置
        if (columnIndex !== -1) {
            // 获取对应组长的信息，假设组长信息在第四行（索引为 3）
            const teamLeader = values[3][columnIndex];

            // 输出结果
            console.log(`${memberName} 的组长是 ${teamLeader}`);

            // 在页面上显示结果
            const searchResultsDiv = document.getElementById('searchResults');
            searchResultsDiv.innerHTML = '';

            const p = document.createElement('p');
            p.textContent = `${memberName} 的组长是 ${teamLeader}`;
            searchResultsDiv.appendChild(p);
        } else {
            // 如果未找到成员
            console.log(`未找到成员 ${memberName}`);

            // 在页面上显示未找到结果
            const searchResultsDiv = document.getElementById('searchResults');
            searchResultsDiv.innerHTML = '';

            const p = document.createElement('p');
            p.textContent = `未找到成员 ${memberName}`;
            searchResultsDiv.appendChild(p);
        }
    });
}

// 示例：搜索成员名字为 "洪智崑" 的组长信息
searchForMember("洪智崑");

</script>

</body>
</html>
