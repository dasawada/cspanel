<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>图片复制示例</title>
</head>
<body>
    <img id="copyIcon" src="chrome_icon.png" alt="Copy Icon" width="60" height="60" style="cursor: pointer;">

    <script>
        document.getElementById('copyIcon').addEventListener('click', async function() {
            try {
                // 获取图片的URL
                const imgURL = document.getElementById('copyIcon').src;

                // 通过fetch获取图片的Blob
                const response = await fetch(imgURL);
                if (!response.ok) {
                    throw new Error('网络响应错误');
                }
                const blob = await response.blob();

                // 创建ClipboardItem并写入剪贴板
                const clipboardItem = new ClipboardItem({ [blob.type]: blob });
                await navigator.clipboard.write([clipboardItem]);

                console.log('图片已复制到剪贴板');
            } catch (error) {
                console.error('复制图片到剪贴板时出错: ', error);
            }
        });

        // 请求剪贴板写权限
        navigator.permissions.query({ name: 'clipboard-write' }).then(result => {
            if (result.state === 'granted') {
                console.log('剪贴板写权限已获得');
            } else if (result.state === 'prompt') {
                console.log('需要用户授予剪贴板写权限');
            } else {
                console.log('没有获得剪贴板写权限');
            }
        });
    </script>
</body>
</html>
